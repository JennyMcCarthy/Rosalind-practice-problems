#!/usr/bin/perl -w
#Jenny McCarthy
#Finding Herve Gene in a sequence
use strict;
my $string ; #Dna file
my $Hervegene = 0; #Number of Herve Gene we are looking for
my $chr_name; #name of the current chromosome
my $chr_seq; #sequence of the current chromosome
#my $start = $-[N] ; #start of the Herves gene macth
#my $end = $+[N] ; #end of the Herves gene macth
#my $N ($1,$2,etc.); #varibales of N
my $hervesseq = "TAGAGTTGTGCCTCAAGAACCAGAACTGTACGATTCATTCAATTCATCCTAAAGAACGAACGACCTACGTTCATCTAATCAACGTTCATCGATTCTTTATAAATTATAATGTGTTGAGTTGTTCATGAAAATAACCCGGGTAGGAACCCGTCGAAATGAAGAACGTCCTAGTACGCCAGGTCGTTCATTCCCCCCATACAAATATGAACGTGAATCGTATGACCAGGACGTTCACGAAAAGAACGTCATACCCGTCGAAATAAAGAACGTCCTAGCAAGCCAGGTCGTTCATTCCCCCCATTCAAAATGAACGTGAATCGTATGACCAGGACGTTCACGAAAAGAACGTCCTACCCGTCGAAATAAAGAACGTCCTAGCAAGTCAGGTCGTTCATTTTTTCCCATACAAATATGAACGTGAATCGTATGACCAGGTCGTTCATTCTCCTGATACAAAAATGCGCTGTCCCACATGATAGACATGTGTCGATGAAACAAAATCAGCATACTTTCTCACTCAGCCCAACAAAACATCCGATCTGGCATTCTGCACTGGCTTTCTGCGGAGAGCACAGTACAAGATAAGAGAGCGGATAGAATGTTTCGTTGATCTACATCGTTGATCTTCACTCTCTTTCTGATCCTCGGAGACGATGCCGCTTCTGCAATATGCGCTCTCTTTTTCTTCCCGCTGCAATACTTTCAGCTGATAGTTACCGAGAGAACGATCACAGAGATAGAGAGTCAAAAAAATGACGAGGACGGGGGGTGGTATGTGGGATGAGTTTTTTTACCTACTTGTGAGCGAGGTACAGTCAAAGTTCAATAATTGAACGAAATTTTGGTTTGTATATTTTTCGATGGATATTTGATAGTAGGTTGATAGATCAACTAAAAAGCATGCCTTTATATTAGTGAATCTAATTTCATAGAAAATCGCAAAACTGTCGCCTATAATGAAAAAAAAACTTCATTTATTTTGTGCAGGAAAGAACGTGAAAATTTATCACCAAACGTGACACTAACCAAACAGTGAGCTGCCAATCGAAGTTCAATTAGTGAGTTTGAACTGTACTAGTCGTTTTGTTTGAGAGAGAAATGACCTTCTCGCGCTTTGAGGAAGAGAGGAAAATTACACTAATACGTTTATGGTCACTAAATCCATATGATAAATACATAGATCACGTATGTTCGGTTCGTTGTTGTATAGGTGATTTTGACCGTTATTTTTGAATACGTTCGATTTCTTCAATGTGTTGTAGGCTTGTGGTAATAAACATTGCTGAAACCGTGATTGTATTGATAAATTGATCTTTGATATGCCATTTGTTGTGATCTTTTGACTTGTAAACCACAAATTGATCTACGCTCCATCGAAATAAGTGAAAATTTAATAATTGCACGGCGATCAAAGGTAACATTAGTCTTGGTAGTTAAAAACAAAAACATAAAGTGTTGTATGAAACATTTCCACAGATATGATGGCTCCAACAAACGCAACAACAAGCCCTGTCTGGGATCATTTTAGTCCGGTAGAAACTGGCGCAAAGTGCCTTTATTGTTTAAAGGTGTTTAAGTATACTAAAGGAACTACTTCGAACTTGAAGCGGCATTTGAATTTAGTGCATAAAACTGTGCCGTATTTAAAGCAAAAGCAACCAATTCCTCAAACTATTAACATAGACGATGAAGCGGGACCTTCTGCTGTAAACTTTCAGCCATCAAATCAATATTTCAATTCAAATATGAGCATACAGGGTTATCTGAAGAAACCCATTAATAGCGAGACTAAAAAGGTTTTAGATAGAATGTTGCTAGATCTAATTTGCAAAGAATGTTTGCCATTTAATTTAGTAGAAAGTGAAATTTTCAAAAAATTCGTTTATACATTAAATCCGAACTATATTATGCCTACACGAAAAAGTTTATCAAACGCCCTACTACCAAGCGTATATAATCAAGAATTTGAAAAGGCTAAAGAGAAATTATCGACCGCCAAAGCTATAGCTATTACGTCGGATGGATGGACAAACCTGAACCAAATAAGTTTTTTTGCCTTAACAGGTCATTATATCGACGAAAATTGCAAACTTAGTTCTATTTTGATAGAATGCTCGGAATTTGAAAATCCTCATAGTGGTAGGAATATAGCTAATTGGATTCAAGGTACCTTGAACAAATTTGACATAGAGGATAAGATTGTTGCAATGGTTACTGACAATGCTTCCAATATGAAAGCGGCATCAACTGAGTTGAATTTTTGTCACATACCATGTTTTGCACATACGTTAAATTTGATTGTTCGAGATGCTATAAAAAAAAGTGTGCTACCAGTTGTAGAAGAGGTAAAAAGAGTAGTAATGTTATTTAAGAAAAGTCCAAAAGCCTCACAAATGCTAGCTGATACACAAAAAAAGCTCAATTTAGATCAATTGAAAATGATACAAGAAGTGTCAACGCGATGGAATTCGGGGTATGATATGCTTAATCGATTTTATAAGAACAAAATTGCATTACTCTCCTGTGCAGATAGTTTGAAAATGAAAATATCTTTAGAATCTCATGATTGGGAAGCAATTGAACAAATTGTGAGGGTTCTAAAATATTTCTATTCTGCTACAAATATTGTATCCGCCCAAAAATACATAACCATTTCACACGTGGGATTACTATGCAATGTGCTGTTAACCAAAACATCACAGTTTAGAAATGATGAGGATATAGCAGAAAACATTCAAAATTTAGTAGCTTTGCTCATTGAAGGTCTACAAAACAAGCTAAAAATTTATCGTTCCAATGAGCAGATACTTAAATCTATGATATTAGATCCTAGGATTAAACAACTTGGCTTTCAAGACGATGTGGAAAAATTCAAAAACATATGTGAATCAATTATATCTGAGCTGCTTCCGTTGCAAAAGCCCGCAGTAGAAGTCGAAAAAGTAGTAAAAAAAGTTAGCAAGGATGTGGACATGCTTTTCGGCGATTTATTAAAAAACAAGGGAGCTCAAAACTACAAAACACCTAGACAAATAGCTGAGAATGAACTACATCAATATTTAAGCGTTGAAAATATTGATTTAGAAAATGATCCGCTTCTTTGGTGGAAAGAACATCAAGTTCTTTATCCATCATTGTATACTCTTGCCATGAGCACTTTATGCATTCCCGGAACGTCCGTTCCATGTGAAAGGCTTTTTTCTAAAGCGGGACAGATATACTCTGAAAAAAGATCTCGACTAGCGCCAAAAAAATTGCAGGAAATATTGTTTATTCAACAAAATGCATAATCAAAACGTCGTTGCAAAATTTGTAACATGGAATATATGAAATAATTGTTTTGTAATGCACTTTTTGTAATTAAGTAAGACTTGAATTATCTAGATGTAAGTGTTATTTTTGTAATATAAAAAATGAATTCAAAATGGTGTTAAAATGTGTTGGTTGCCTTAATCATAATAGATGCATCACTTAATAACATAATTAGGAATACACGAGTTTTTTAGTTCAGTGACTAAGAACTGTTATGCTTATTATATGAAACTGTTAACAAACACCCATAATATGAAACTATCGCGAAATAAGATCGATTTACCATACTGTGGTTAGTTGACGTGAACGATTGAATCGCGATTCACGCTCAGTTCATGTTAATGAAAGAACCGGTAAATTCACGTTCATGGTAATGAATCGAATTGCCCAACCCTA";
my $substrherves = substr($hervesseq, 0, 10);

#open the file and stat a string

open (FILE, $ARGV[0]) or die "Cannot open $ARGV[0] : $!";

##### process the first line
$string = <FILE>;
if ($string =~ /^>/) {
	$chr_name = $string;
}
else {
	die ("first line does not start with greater than symbol");
}

##### process the rest of the file
while ($string = <FILE>) {
	chomp $string;
	if ($string =~ /^>/) {
		while ($chr_seq =~ /$substrherves/ig) {
			$Hervegene++;
		}
		print "In chromosome $chr_name there are $Hervegene instance of Herves\n";
		#print "location of sequence starting at $start ending at $end\n";	
		$chr_name = $string;
		$chr_seq = "";
	}
	else {
		$chr_seq .= $string;
	}
#	while ($string =~ /$substrherves/ig) {
#		$Hervegene++;
#	}
}
while ($chr_seq =~ /$substrherves/ig) {
	$Hervegene++;
}
print "In chromosome $chr_name there are $Hervegene instance of Herves\n";
close (FILE);
#print "number of Herves genes $Hervegene\n";
#print "$substrherves\n";
